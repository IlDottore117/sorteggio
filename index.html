<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sorteggio</title>
</head>
<body>
    <h1>Sorteggio</h1>
    <p>Inserisci il tuo nome per evitare di essere sorteggiato:</p>
    <input type="text" id="nomeUtente" placeholder="Il tuo nome">
    <button id="sorteggia">Sorteggia un nome</button>
    <p id="risultato"></p>
    <script>
        // Lista aggiornata dei nomi
        const nomi = [
            "Beatrice", "Marco", "Federico", "Salvatore", "Federica",
            "Alessio", "Valentina", "Livia", "Cristina",
            "Alessandro", "Manola", "Valeria", "Pierluigi", "Dario"
        ];

        let estratti = JSON.parse(localStorage.getItem('estratti')) || [];
        let nomeUtente = localStorage.getItem('utenteNome') || "";

        document.getElementById("nomeUtente").value = nomeUtente;

        document.getElementById("sorteggia").addEventListener("click", () => {
            const nomeInput = document.getElementById("nomeUtente").value.trim();
            
            if (!nomeInput) {
                alert("Per favore, inserisci il tuo nome.");
                return;
            }

            if (!nomeUtente) {
                nomeUtente = nomeInput;
                localStorage.setItem("utenteNome", nomeUtente);
            }

            if (nomeUtente !== nomeInput) {
                alert("Il nome non corrisponde a quello della sessione. Ricarica la pagina per resettare.");
                return;
            }

            if (estratti.includes(nomeUtente)) {
                document.getElementById("risultato").innerText = "Hai a disposizione una sola estrazione!";
                return;
            }

            const nomiDisponibili = nomi.filter(nome => nome !== nomeUtente && !estratti.includes(nome));

            if (nomiDisponibili.length === 0) {
                document.getElementById("risultato").innerText = "Tutti i nomi sono stati estratti!";
                return;
            }

            const sorteggiato = nomiDisponibili[Math.floor(Math.random() * nomiDisponibili.length)];
            estratti.push(sorteggiato);
            localStorage.setItem("estratti", JSON.stringify(estratti));

            document.getElementById("risultato").innerText = `Nome sorteggiato: ${sorteggiato}`;
        });
    </script>
</body>
</html>